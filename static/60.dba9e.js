webpackJsonp([60],{"9Upo":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapDispatchToProps=t.mapStateToProps=undefined;var n=y(a("1cZb")),s=y(a("trpn")),i=y(a("aCj6")),l=y(a("yF52")),r=y(a("IidI")),u=y(a("vaID")),o=y(a("uuhB")),c=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a("YaoS"),a("Op6J"),a("kJGR"),a("tNTX"),a("1uA9"),a("nclB"),a("TZP0");var f=a("U7vG"),h=y(f),_=a("4n+p"),d=a("Pq8k"),p=a("Zfgq"),g=y(a("mtWM")),m=a("y3Xk");function y(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=function(e){function t(){var e,a,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,i=Array(s),l=0;l<s;l++)i[l]=arguments[l];return a=n=b(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n.state={loading:!1,messages:[],page:0,size:10,total:0,selectRows:[],searchValue:"",visible:!1,title:"",okText:"",cancelText:"",newSelfType:""},b(n,a)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,f.Component),c(t,[{key:"componentDidMount",value:function(){this.fetchData(this.props.userId,this.state.page,this.state.size)}},{key:"render",value:function(){var e=this,t=this.language("user_service_message_sent_title_label"),a=this.language("user_service_message_sent_type_label"),n=this.language("user_service_message_sent_self_type_label"),c=this.language("user_service_message_sent_actor_label"),f=this.language("user_service_message_sent_notifiers_label"),_=this.language("user_service_message_sent_postOn_label"),d=this.language("user_service_message_sent_new_self_type_placeholder"),p=this.language("user_service_message_sent_panel_title"),g=this.language("user_service_message_sent_publish_btn_label"),y=this.language("user_service_message_sent_drawback_btn_label"),b=this.language("user_service_message_sent_define_type_btn_label"),v=this.language("user_service_message_sent_search_placeholder"),k=this.language("user_service_message_sent_search_btn_label"),w=this.language("user_service_message_sent_drawback_success_txt"),C=this.language("user_service_message_sent_drawback_fail_txt"),S=this.language("user_service_message_sent_new_self_type_title"),T=this.language("user_service_message_sent_new_self_type_ok_btn"),x=this.language("user_service_message_sent_new_self_type_cancel_btn"),E=this.language("user_service_message_sent_new_self_type_success_txt"),I=this.language("user_service_message_sent_new_self_type_fail_txt"),O=[{title:t,dataIndex:"title",key:"title",render:function(t,a,n){return h.default.createElement("a",{onClick:function(){return e.onLinkClick.bind(e)(t,a,n)}},t)}},{title:a,dataIndex:"type",key:"type"},{title:n,dataIndex:"selfType",key:"selfType"},{title:c,dataIndex:"actor",key:"actor"},{title:f,dataIndex:"notifiers",key:"notifiers"},{title:_,dataIndex:"postOn",key:"postOn",render:function(e){return(0,m.toLocaleString)(e)}}],P={selectedRowKeys:this.state.selectRows,onChange:function(t,a){e.setState({selectRows:t})},onSelect:function(e,t,a){},onSelectAll:function(e,t,a){},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name}}},D={pageSize:10,current:1,total:4,defaultCurrent:1,defaultPageSize:10,showSizeChanger:!0,pageSizeOptions:["10","20","30"],showQuickJumper:!0,onShowSizeChange:function(t,a){e.fetchData(e.props.userId,e.state.page,a)},onChange:function(t){e.fetchData(e.props.userId,t-1,e.props.size)}};return h.default.createElement("div",{style:{background:"white",height:"100vh",padding:"24px"}},h.default.createElement(s.default,{spinning:this.state.loading,size:"large"},h.default.createElement(u.default,{title:this.state.title,visible:this.state.visible,okText:this.state.okText,cancelText:this.state.cancelText,onOk:function(){return e.handleOk.bind(e)(E,I)},onCancel:this.handleCancel.bind(this)},h.default.createElement(o.default,{placeholder:d,value:this.state.newSelfType,onChange:this.onInputChange.bind(this)})),h.default.createElement(i.default,{title:p},h.default.createElement("div",{style:{display:"flex",flexDirection:"column",margin:"0 auto",background:"white"}},h.default.createElement("div",{style:{marginBottom:12,display:"flex",justifyContent:"space-between"}},h.default.createElement("div",null,h.default.createElement(r.default,{style:{marginRight:4},onClick:this.onPublishClick.bind(this)},g),h.default.createElement(r.default,{style:{marginRight:4},onClick:function(){return e.onDrawbackClick.bind(e)(w,C)},disabled:0===this.state.selectRows.length},y),h.default.createElement(r.default,{onClick:function(){return e.onCustomClick.bind(e)(S,T,x)}},b)),h.default.createElement("div",{style:{display:"flex"}},h.default.createElement(o.default,{placeholder:v,style:{marginRight:4},value:this.state.searchValue,onChange:this.onSearchChange.bind(this)}),h.default.createElement(r.default,{type:"primary",onClick:this.onSearchClick.bind(this)},k))),h.default.createElement(l.default,{columns:O,dataSource:this.state.messages,rowSelection:P,pagination:D,size:"middle"})))))}},{key:"fetchData",value:function(e,t,a){var n=this;this.setState({loading:!0}),(0,g.default)({url:"/api-user/messageProjections?actorId="+e+"&type="+this.state.searchValue+"&page="+t+"&size="+a,method:"GET"}).then(function(e){n.setState({loading:!1,messages:e.data.content.map(function(e){return{key:e.id,actor:e.actor,action:e.action,content:e.content,notifiers:e.notifiers,postOn:e.postOn,selfType:e.selfType,type:e.type,title:e.title}}),page:e.data.pageable.pageNumber,size:e.data.pageable.pageSize,total:e.data.totalElements})},function(e){}).catch(function(e){})}},{key:"onPublishClick",value:function(){p.browserHistory.push("/console/message-new")}},{key:"onDrawbackClick",value:function(e,t){var a=this;(0,g.default)({url:"/api-user/notificaitonObjects/"+this.state.selectRows.join(","),method:"DELETE"}).then(function(t){n.default.success(e),a.fetchData(a.props.userId,0,a.state.size)}).catch(function(e){n.default.error(t)})}},{key:"onCustomClick",value:function(e,t,a){this.setState({visible:!0,title:e,okText:t,cancelText:a})}},{key:"onInputChange",value:function(e){this.setState({newSelfType:e.target.value})}},{key:"handleOk",value:function(e,t){var a=this;(0,g.default)({url:"/api-user/messageSelfDefinedTypes?name="+this.state.newSelfType,method:"POST"}).then(function(t){a.setState({visible:!1}),n.default.success(e)},function(e){n.default.error(t)}).catch(function(e){n.default.error(t)})}},{key:"handleCancel",value:function(){this.setState({visible:!1})}},{key:"onSearchChange",value:function(e){this.setState({searchValue:e.target.value})}},{key:"onSearchClick",value:function(){this.fetchData(this.props.userId,0,this.state.size)}},{key:"onLinkClick",value:function(e,t,a){this.props.dispatch({type:"/message-center/CLICK_LINK",data:t.key})}},{key:"language",value:function(e){return this.props.intl.formatMessage({id:e})}}]),t}(),k=t.mapStateToProps=function(e){return{clickId:e.messageCenterReducer.clickId,username:e.authentication.username,userId:e.authentication.userId}},w=t.mapDispatchToProps=function(e){return{dispatch:e}};t.default=(0,_.connect)(k,w)((0,d.injectIntl)(v))}});