webpackJsonp([42],{F7Sr:function(e,t,n){(t=e.exports=n("FZ+f")(!0)).push([e.i,".src-scenes-Message-style_logo--2bwDlRRX{height:48px;background:hsla(0,0%,100%,.2);margin:16px}.src-scenes-Message-style_trigger--2pA754Cb{font-size:18px;line-height:64px;padding:0 24px;cursor:pointer;transition:color .3s}.src-scenes-Message-style_trigger--2pA754Cb:hover{color:#1890ff}.src-scenes-Message-style_rowCursor--JB-BcXuD{cursor:pointer}.src-scenes-Message-style_rowCursor--JB-BcXuD:hover{box-shadow:1px 1px 10px rgba(0,0,0,.1)}.src-scenes-Message-style_messageSelection--RD6Yr4Yo{border-bottom:1px solid transparent}.src-scenes-Message-style_messageSelection--RD6Yr4Yo:hover{border-bottom:1px solid rgba(0,0,0,.7)}.src-scenes-Message-style_detailContainer--3NV0agDv{width:100%;margin:0 auto;padding:16px;display:flex;flex-direction:column}.src-scenes-Message-style_detailSubject--3qDXwIFO{display:flex;align-items:center;margin-bottom:8px}.src-scenes-Message-style_detailFromToInfo--3ntR9Sye{display:flex;justify-content:space-between;padding:4px}.src-scenes-Message-style_detailsFromTo--1rh1oPd5{display:flex;flex-direction:column}.src-scenes-Message-style_detailsInfoSmall--3-E90FZN{color:#5f6368;font-size:.75rem;margin-left:8px}.src-scenes-Message-style_detailContent--1GRUlTtG{padding:4px}","",{version:3,sources:["D:/siacloud2/sia-cloud-foundation-v2/frontend/src/scenes/Message/D:/siacloud2/sia-cloud-foundation-v2/frontend/src/scenes/Message/style.less","D:/siacloud2/sia-cloud-foundation-v2/frontend/src/scenes/Message/style.less"],names:[],mappings:"AAAA,yCACE,YAAA,AACA,8BAAA,AACA,WAAA,CCCD,ADED,4CACE,eAAA,AACA,iBAAA,AACA,eAAA,AACA,eAAA,AACA,oBAAA,CCAD,ADGD,kDACE,aAAA,CCDD,ADID,8CACE,cAAA,CCFD,ADKD,oDACE,sCAAA,CCHD,ADMD,qDACE,mCAAA,CCJD,ADOD,2DACE,sCAAA,CCLD,ADQD,oDACE,WAAA,AACA,cAAA,AACA,aAAA,AACA,aAAA,AACA,qBAAA,CCND,ADSD,kDACE,aAAA,AACA,mBAAA,AACA,iBAAA,CCPD,ADUD,qDACE,aAAA,AACA,8BAAA,AACA,WAAA,CCRD,ADWD,kDACE,aAAA,AACA,qBAAA,CCTD,ADYD,qDACE,cAAA,AACA,iBAAA,AACA,eAAA,CCVD,ADaD,kDACE,WAAA,CCXD",file:"style.less",sourcesContent:[".logo {\n  height: 48px;\n  background: rgba(255, 255, 255, .2);\n  margin: 16px;\n}\n\n.trigger {\n  font-size: 18px;\n  line-height: 64px;\n  padding: 0 24px;\n  cursor: pointer;\n  transition: color .3s;\n}\n\n.trigger:hover {\n  color: #1890ff;\n}\n\n.rowCursor {\n  cursor: pointer;\n}\n\n.rowCursor:hover {\n  box-shadow: 1px 1px 10px rgba(0, 0, 0, 0.1);\n}\n\n.messageSelection {\n  border-bottom: 1px solid transparent;\n}\n\n.messageSelection:hover {\n  border-bottom: 1px solid rgba(0, 0, 0, .7);\n}\n\n.detailContainer {\n  width: 100%;\n  margin: 0 auto;\n  padding: 16px;\n  display: flex;\n  flex-direction: column;\n}\n\n.detailSubject {\n  display: flex;\n  align-items: center;\n  margin-bottom: 8px;\n}\n\n.detailFromToInfo {\n  display: flex;\n  justify-content: space-between;\n  padding: 4px;\n}\n\n.detailsFromTo {\n  display: flex;\n  flex-direction: column;\n}\n\n.detailsInfoSmall {\n  color: #5f6368;\n  font-size: 0.75rem;\n  margin-left: 8px\n}\n\n.detailContent {\n  padding: 4px\n}\n\n",".logo {\n  height: 48px;\n  background: rgba(255, 255, 255, 0.2);\n  margin: 16px;\n}\n.trigger {\n  font-size: 18px;\n  line-height: 64px;\n  padding: 0 24px;\n  cursor: pointer;\n  transition: color .3s;\n}\n.trigger:hover {\n  color: #1890ff;\n}\n.rowCursor {\n  cursor: pointer;\n}\n.rowCursor:hover {\n  box-shadow: 1px 1px 10px rgba(0, 0, 0, 0.1);\n}\n.messageSelection {\n  border-bottom: 1px solid transparent;\n}\n.messageSelection:hover {\n  border-bottom: 1px solid rgba(0, 0, 0, 0.7);\n}\n.detailContainer {\n  width: 100%;\n  margin: 0 auto;\n  padding: 16px;\n  display: flex;\n  flex-direction: column;\n}\n.detailSubject {\n  display: flex;\n  align-items: center;\n  margin-bottom: 8px;\n}\n.detailFromToInfo {\n  display: flex;\n  justify-content: space-between;\n  padding: 4px;\n}\n.detailsFromTo {\n  display: flex;\n  flex-direction: column;\n}\n.detailsInfoSmall {\n  color: #5f6368;\n  font-size: 0.75rem;\n  margin-left: 8px;\n}\n.detailContent {\n  padding: 4px;\n}\n"],sourceRoot:""}]),t.locals={logo:"src-scenes-Message-style_logo--2bwDlRRX",trigger:"src-scenes-Message-style_trigger--2pA754Cb",rowCursor:"src-scenes-Message-style_rowCursor--JB-BcXuD",messageSelection:"src-scenes-Message-style_messageSelection--RD6Yr4Yo",detailContainer:"src-scenes-Message-style_detailContainer--3NV0agDv",detailSubject:"src-scenes-Message-style_detailSubject--3qDXwIFO",detailFromToInfo:"src-scenes-Message-style_detailFromToInfo--3ntR9Sye",detailsFromTo:"src-scenes-Message-style_detailsFromTo--1rh1oPd5",detailsInfoSmall:"src-scenes-Message-style_detailsInfoSmall--3-E90FZN",detailContent:"src-scenes-Message-style_detailContent--1GRUlTtG"}},Ipnr:function(e,t,n){var s=n("F7Sr");"string"==typeof s&&(s=[[e.i,s,""]]);n("fjbf")(s,{});s.locals&&(e.exports=s.locals)},xkUu:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=y(n("trpn")),a=y(n("yF52")),r=y(n("0b0c")),o=y(n("ExGt")),i=y(n("vgHw")),l=y(n("N5r7")),c=y(n("IidI")),d=y(n("1cZb")),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();n("Op6J"),n("tNTX"),n("kxBb"),n("2r77"),n("ZJow"),n("XJFJ"),n("1uA9"),n("YaoS");var p=n("U7vG"),f=y(p),A=y(n("mtWM")),m=n("4n+p"),g=y(n("Ipnr")),h=n("y3Xk"),C=y(n("PJh5"));function y(e){return e&&e.__esModule?e:{default:e}}var D=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getMessageUserDetail=function(e){(0,A.default)("/api-message/readDetail/message/"+e+"/user/"+n.props.userId,{contentType:"application/json"}).then(function(e){e.data&&n.setState({showUserList:e.data})})},n.getMessageDetail=function(e){n.setState({loading:!0}),(0,A.default)("/api-message/notifications/"+n.props.userId+"?messageId="+e+"&type="+n.props.routeParams.type,{contentType:"application/json"}).then(function(e){e.data&&n.setState({loading:!1,creator:e.data.senderName,recipients:e.data.receiverNames,createTime:(0,C.default)(e.data.createdTime),messageBody:e.data.content,subject:e.data.subject,type:e.data.messageTypeName,version:e.data.version})}).catch(function(e){d.default.error("显示失败"),n.setState({loading:!1})})},n.onDeleteClick=function(){"receive"===n.props.routeParams.type?(0,A.default)({method:"delete",url:"/api-message/notifications/"+n.props.userId,contentType:"application/json",withCredentials:!0,data:[{messageId:n.props.routeParams.id,version:n.state.version}]}).catch(function(e){d.default.error("隐藏失败"),n.props.onReturn()}):"send"===n.props.routeParams.type?(0,A.default)({method:"delete",url:"/api-message/send-notifications/"+n.props.userId,contentType:"application/json",withCredentials:!0,data:[{messageId:n.props.routeParams.id,version:n.state.version}]}).catch(function(e){d.default.error("隐藏失败"),n.props.onReturn()}):d.default.error("隐藏失败")},n.state={importance:"normal",loading:!1,creator:"",recipients:"",createTime:"",messageBody:"",subject:"",type:"",version:"",showDetail:!1,showUserList:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p.Component),u(t,[{key:"componentDidMount",value:function(){this.props.userName&&this.props.userId&&(this.getMessageDetail(this.props.routeParams.id),this.getMessageUserDetail(this.props.routeParams.id))}},{key:"componentDidUpdate",value:function(e){this.props.userName&&this.props.userId&&this.props.userName!==e.userName&&this.props.userId!==e.userId&&(this.getMessageDetail(this.props.routeParams.id),this.getMessageUserDetail(this.props.routeParams.id))}},{key:"render",value:function(){var e=this,t=f.default.createElement("div",{style:{display:"flex",justifyContent:"flex-start",marginTop:24}},f.default.createElement(c.default,{style:{marginRight:4},onClick:function(){e.props.onReturn()}},"返回"),f.default.createElement(c.default,{type:"danger",onClick:this.onDeleteClick},"隐藏"));return f.default.createElement(s.default,{spinning:this.state.loading,size:"large"},f.default.createElement("h2",null,"消息详情"),f.default.createElement("hr",null),f.default.createElement("div",{className:g.default.detailContainer},f.default.createElement("div",{className:g.default.detailSubject},f.default.createElement("h2",{style:{marginBottom:0,marginRight:8,fontSize:"1.375rem"}},this.state.subject),f.default.createElement(l.default,null,this.state.type),"IMPORTANT"===this.state.importance?f.default.createElement(o.default,{title:"重要邮件",placement:"right",arrowPointAtCenter:!0},f.default.createElement(i.default,{type:"flag",style:{color:"#f5222d",fontWeight:400}})):null),f.default.createElement("div",{className:g.default.detailFromToInfo},f.default.createElement("div",{className:g.default.detailsFromTo},f.default.createElement("h3",{style:{color:"#202124",marginBottom:0,fontSize:".875rem"}},this.state.creator),f.default.createElement("span",{className:g.default.detailsInfoSmall},"发送至 ",this.state.recipients)),f.default.createElement("span",{className:g.default.detailsInfoSmall},(0,h.toLocaleString)(this.state.createTime))),f.default.createElement("div",{style:{border:"0.5px solid rgba(0,0,0,.08)",marginBottom:8}}),"send"===this.props.routeParams.type&&f.default.createElement("div",null,f.default.createElement(r.default,null,!this.state.showDetail&&f.default.createElement("a",{onClick:function(){e.setState({showDetail:!0})}},"[查看详情]"),this.state.showDetail&&f.default.createElement("a",{onClick:function(){e.setState({showDetail:!1})}},"[隐藏详情]")),this.state.showDetail&&f.default.createElement("div",{style:{background:"#ECECEC",padding:"30px"}},f.default.createElement("div",{style:{background:"#FFFFFF"}},f.default.createElement(a.default,{columns:x,dataSource:this.state.showUserList,rowKey:function(e){return e.receiverId},size:"small",bordered:!0,pagination:{pageSize:2}})))),f.default.createElement("div",{className:g.default.detailContent},f.default.createElement("p",null,this.state.messageBody)),t))}}]),t}(),x=[{title:"姓名",dataIndex:"receiverName"},{title:"是否已读",dataIndex:"ifRead",render:function(e,t,n){return"true"===e?"是":"否"}}];t.default=(0,m.connect)(function(e){return{userId:e.authentication.userId,userName:e.authentication.username}},function(e,t){return{dispatch:e,onReturn:function(e){t.history.goBack()}}})(D)}});