webpackJsonp([41],{Dec5:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=w(a("trpn")),s=w(a("yF52")),r=w(a("0b0c")),i=w(a("G3dI")),l=w(a("IidI")),o=w(a("uuhB")),p=w(a("NJOH")),u=w(a("1cZb")),c=w(a("vaID")),d=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a("Op6J"),a("tNTX"),a("kxBb"),a("/Hhv"),a("1uA9"),a("TZP0"),a("mKHw"),a("YaoS"),a("nclB");var f=a("U7vG"),h=w(f),m=a("4n+p"),y=w(a("mtWM")),g=w(a("KFkU")),b=w(a("XLJV"));function w(e){return e&&e.__esModule?e:{default:e}}var E=c.default.confirm,v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.getAppList=function(e){(0,y.default)("/api-user/getApps/"+e).then(function(e){return e.data}).then(function(e){a.setState({appList:e,app:e.length>0?e[0].appId:""}),e.length>0?a.getMessageType(e[0].appId,"",0,10):a.setState({loading:!1})}).catch(function(e){u.default.error("暂无应用列表"),a.setState({loading:!1})})},a.selectedTypes=function(e,t){a.setState({selectedRowKeys:e,selectedRows:t})},a.getMessageType=function(e,t,n,s){(0,y.default)("/api-message/notificationTypes?appId="+e+"&name="+t+"&enterprise="+a.props.enterprises[a.props.currentEnterprise].id+"&page="+n+"&size="+s).then(function(e){a.setState({typeList:e.data.content,total:e.data.totalElements,size:e.data.size,page:e.data.number,selectedRowKeys:[],selectedRows:[],loading:!1})}).catch(function(e){u.default.error("暂无消息类别"),a.setState({loading:!1})})},a.modalCancel=function(){a.setState({insertVisible:!1,deleteVisible:!1,modifyVisible:!1})},a.modalOk=function(){a.setState({insertVisible:!1,deleteVisible:!1,modifyVisible:!1,selectedRowKeys:[],selectedRows:[]}),a.getMessageType(a.state.app,a.state.title,0,10)},a.deleteMessageType=function(){a.setState({loading:!0}),(0,y.default)({method:"delete",url:"/api-message/notificationTypes",contentType:"application/json",withCredentials:!0,data:{id:a.state.selectedRows[0].id,version:a.state.selectedRows[0].version}}).then(function(e){200===e.status?u.default.success("删除成功"):u.default.error("删除失败"),a.getMessageType(a.state.app,a.state.title,0,10)}).catch(function(e){u.default.error("删除失败"),a.setState({loading:!1})})},a.state={appList:[],app:"",selectedRowKeys:[],selectedRows:[],loading:!1,title:"",typeList:[],insertVisible:!1,deleteVisible:!1,modifyVisible:!1,total:0,size:10,page:0},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,f.Component),d(t,[{key:"componentDidMount",value:function(){this.props.enterprises[this.props.currentEnterprise]&&this.getAppList(this.props.enterprises[this.props.currentEnterprise].id)}},{key:"componentDidUpdate",value:function(e){!this.props.enterprises[this.props.currentEnterprise]||this.props.currentEnterprise===e.currentEnterprise&&this.props.enterprises===e.enterprises||(this.setState({loading:!0}),this.getAppList(this.props.enterprises[this.props.currentEnterprise].id))}},{key:"render",value:function(){var e=this;if(this.props.enterprises[this.props.currentEnterprise]){var t=this.state,a=t.selectedRowKeys,u=t.selectedRows,d={total:this.state.total,pageSize:this.state.size,current:this.state.page+1,showSizeChanger:!0,pageSizeOptions:["10","15","20"],showQuickJumper:!0,onShowSizeChange:function(t,a){e.getMessageType(e.state.app,e.state.title,0,a)},onChange:function(t){e.getMessageType(e.state.app,e.state.title,t-1,e.state.size)}};return h.default.createElement(n.default,{spinning:this.state.loading,size:"large"},h.default.createElement("h2",null,"消息类别管理"),h.default.createElement("hr",null),this.state.selectedRows.length>0&&h.default.createElement(c.default,{title:"新增消息类别",visible:this.state.insertVisible,onCancel:this.modalCancel,onOk:this.modalOk,footer:null,maskClosable:!1,destroyOnClose:!0},h.default.createElement(g.default,{showModalCancel:this.modalCancel.bind(this),showModalOK:this.modalOk.bind(this),appId:this.state.app,appName:this.state.appList.find(function(t){return t.appId===e.state.app}).appName,enterpriseId:this.props.enterprises[this.props.currentEnterprise].id,createUser:this.props.userId})),this.state.selectedRows.length>0&&h.default.createElement(c.default,{title:"修改消息类别",visible:this.state.modifyVisible,onCancel:this.modalCancel,onOk:this.modalOk,footer:null,maskClosable:!1,destroyOnClose:!0},h.default.createElement(b.default,{showModalCancel:this.modalCancel.bind(this),showModalOK:this.modalOk.bind(this),messageType:this.state.selectedRows[0],appId:this.state.app,appName:this.state.appList.find(function(t){return t.appId===e.state.app}).appName,enterpriseId:this.props.enterprises[this.props.currentEnterprise].id,createUser:this.props.userId})),h.default.createElement(r.default,{style:{marginBottom:10}},h.default.createElement(i.default,{type:"flex",justify:"center"},h.default.createElement("span",null,"应用："),h.default.createElement(p.default,{style:{width:"300",marginRight:8},value:this.state.app,onChange:function(t){e.setState({app:t}),e.getMessageType(e.state.app,e.state.title,0,10)}},this.state.appList.map(function(e){return h.default.createElement(p.default.Option,{key:e.appId,value:e.appId},e.appName)})),h.default.createElement("span",{style:{marginLeft:16}},"名称："),h.default.createElement(o.default,{placeholder:"查询",value:this.state.title,onChange:function(t){e.setState({title:t.target.value})},style:{width:300}}),h.default.createElement(l.default,{type:"primary",disabled:!this.state.app,style:{marginLeft:8},onClick:function(){e.getMessageType(e.state.app,e.state.title,0,10)}},"查询"))),h.default.createElement(r.default,{type:"flex",style:{marginBottom:8}},h.default.createElement("div",null,h.default.createElement(l.default,{id:"new",type:"primary",style:{marginRight:8},disabled:!this.state.app,onClick:function(){e.setState({insertVisible:!0})}},"新建"),h.default.createElement(l.default,{id:"modify",onClick:function(){e.setState({modifyVisible:!0})},style:{marginRight:4},disabled:!this.state.app||0===this.state.selectedRowKeys.length},"修改"),h.default.createElement(l.default,{id:"delete",type:"danger",style:{marginRight:8},disabled:!this.state.app||0===this.state.selectedRowKeys.length,onClick:function(){E({title:"确定删除该条记录吗?",okTest:"确定",cancelText:"关闭",onOk:function(){e.deleteMessageType()},onCancel:function(){}})}},"删除"))),h.default.createElement(r.default,null,h.default.createElement(s.default,{rowSelection:{selectedRowKeys:a,selectedRows:u,type:"radio",onChange:this.selectedTypes},columns:[{title:"名称",dataIndex:"name",align:"center"}],dataSource:this.state.typeList,showHeader:!0,pagination:d,rowKey:function(e){return e.id}})))}return null}}]),t}();t.default=(0,m.connect)(function(e){return{enterprises:e.userData.enterprises,currentEnterprise:e.userData.currentEnterprise,userId:e.authentication.userId}},function(e){return{dispatch:e}})(v)},KFkU:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(a("trpn")),s=h(a("IidI")),r=h(a("uuhB")),i=h(a("1cZb")),l=h(a("vaID")),o=h(a("37+n")),p=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a("Op6J"),a("1uA9"),a("TZP0"),a("YaoS"),a("nclB"),a("8QNH");var u=a("U7vG"),c=h(u),d=h(a("mtWM")),f=a("Pq8k");function h(e){return e&&e.__esModule?e:{default:e}}var m=o.default.Item,y=l.default.confirm,g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){e||(a.setState({loading:!0}),(0,d.default)({method:"post",url:"/api-message/notificationTypes",contentType:"application/json",withCredentials:!0,data:{name:t.name,appId:a.props.appId,enterpriseId:a.props.enterpriseId,createUser:a.props.createUser,ifDeleted:!1}}).then(function(e){a.setState({loading:!1}),200===e.status?(i.default.success("新建成功"),a.props.showModalOK()):i.default.error("新建失败")}).catch(function(e){i.default.error("连接错误"),a.setState({loading:!1})}))})},a.state={loading:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.Component),p(t,[{key:"render",value:function(){var e=this,t=this.props.form,a=t.getFieldDecorator,i=t.isFieldsTouched;return c.default.createElement(n.default,{spinning:this.state.loading,size:"large"},c.default.createElement(o.default,{onSubmit:this.handleSubmit,layout:"horizontal"},c.default.createElement(m,{label:"应用名称",labelCol:{span:6},wrapperCol:{span:16}},a("appName1",{initialValue:this.props.appName?this.props.appName:""})(c.default.createElement(r.default,{disabled:!0}))),c.default.createElement(m,{label:"消息类别",labelCol:{span:6},wrapperCol:{span:16}},a("name",{rules:[{required:!0,message:"必填"}]})(c.default.createElement(r.default,null))),c.default.createElement(m,{wrapperCol:{xs:{span:12,offset:0},sm:{span:16,offset:6}}},c.default.createElement(s.default,{style:{marginRight:8},type:"primary",htmlType:"submit"},"保存"),c.default.createElement(s.default,{type:"cancle",onClick:function(){i()?y({title:"您有新增内容，确认返回？",okText:"返回",cancelText:"取消",onOk:function(){e.props.showModalCancel()},onCancel:function(){}}):e.props.showModalCancel()}},"关闭"))))}}]),t}();t.default=(0,f.injectIntl)(o.default.create()(g))},XLJV:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(a("trpn")),s=h(a("IidI")),r=h(a("uuhB")),i=h(a("1cZb")),l=h(a("vaID")),o=h(a("37+n")),p=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a("Op6J"),a("1uA9"),a("TZP0"),a("YaoS"),a("nclB"),a("8QNH");var u=a("U7vG"),c=h(u),d=h(a("mtWM")),f=a("Pq8k");function h(e){return e&&e.__esModule?e:{default:e}}var m=o.default.Item,y=l.default.confirm,g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){e||(a.setState({loading:!0}),(0,d.default)({method:"patch",url:"/api-message/notificationTypes/"+a.props.messageType.id,contentType:"application/json",withCredentials:!0,data:{name:t.name,appId:a.props.appId,enterpriseId:a.props.enterpriseId,createUser:a.props.createUser,ifDeleted:!1,version:a.props.messageType.version}}).then(function(e){a.setState({loading:!1}),200===e.status?(i.default.success("新建成功"),a.props.showModalOK()):i.default.error("新建失败")}).catch(function(e){i.default.error("连接错误"),a.setState({loading:!1})}))})},a.state={loading:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.Component),p(t,[{key:"render",value:function(){var e=this,t=this.props.form,a=t.getFieldDecorator,i=t.isFieldsTouched;return c.default.createElement(n.default,{spinning:this.state.loading,size:"large"},c.default.createElement(o.default,{onSubmit:this.handleSubmit,layout:"horizontal"},c.default.createElement(m,{label:"应用名称",labelCol:{span:6},wrapperCol:{span:16}},a("appName1",{initialValue:this.props.appName?this.props.appName:""})(c.default.createElement(r.default,{disabled:!0}))),c.default.createElement(m,{label:"消息类别",labelCol:{span:6},wrapperCol:{span:16}},a("name",{initialValue:this.props.messageType.name,rules:[{required:!0,message:"必填"}]})(c.default.createElement(r.default,null))),c.default.createElement(m,{wrapperCol:{xs:{span:12,offset:0},sm:{span:16,offset:6}}},c.default.createElement(s.default,{style:{marginRight:8},type:"primary",htmlType:"submit"},"保存"),c.default.createElement(s.default,{type:"cancle",onClick:function(){i()?y({title:"您有新增内容，确认返回？",okText:"返回",cancelText:"取消",onOk:function(){e.props.showModalCancel()},onCancel:function(){}}):e.props.showModalCancel()}},"关闭"))))}}]),t}();t.default=(0,f.injectIntl)(o.default.create()(g))}});