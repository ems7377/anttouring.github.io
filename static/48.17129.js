webpackJsonp([48],{A82k:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(a("0b0c")),r=v(a("G3dI")),s=v(a("aCj6")),o=v(a("vgHw")),l=v(a("vaID")),u=v(a("IidI")),c=v(a("PVZZ")),i=v(a("1cZb")),p=v(a("uuhB")),d=v(a("37+n")),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},h=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a("kxBb"),a("/Hhv"),a("kJGR"),a("ZJow"),a("nclB"),a("1uA9"),a("NZBz"),a("YaoS"),a("TZP0"),a("8QNH");var b=v(a("U7vG")),m=a("Pq8k"),y=v(a("mtWM"));function v(e){return e&&e.__esModule?e:{default:e}}var g=d.default.Item,_=p.default.TextArea,E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.getTsDatabasePrice=a.getTsDatabasePrice.bind(a),a.showTermsModal=a.showTermsModal.bind(a),a.handleCancel=a.handleCancel.bind(a),a.checkboxChange=a.checkboxChange.bind(a),a.getLeaseTermDiscount=a.getLeaseTermDiscount.bind(a),a.postTsDatabase=a.postTsDatabase.bind(a),a.getAccountBalance=a.getAccountBalance.bind(a),a.showBalanceModal=a.showBalanceModal.bind(a),a.state={tsDatabasePrice:"0",termsModalVisible:!1,checkboxStatus:!1,discount:"1",accountId:"",balance:"",balanceModalVisible:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b.default.Component),h(t,[{key:"componentDidMount",value:function(){this.props.form.resetFields(),this.getAccountBalance()}},{key:"showTermsModal",value:function(){this.setState({termsModalVisible:!0})}},{key:"handleCancel",value:function(){this.setState({termsModalVisible:!1,balanceModalVisible:!1})}},{key:"showBalanceModal",value:function(){this.setState({balanceModalVisible:!0})}},{key:"checkboxChange",value:function(e){this.setState({checkboxStatus:e.target.checked})}},{key:"getTsDatabasePrice",value:function(e){var t=this;(0,y.default)({method:"GET",url:"/api-tenant/tsDatabasePrices?max="+e,contentType:"application/json"}).then(function(e){200===e.status&&t.setState({tsDatabasePrice:e.data[0].fees})})}},{key:"getLeaseTermDiscount",value:function(e){var t=this;(0,y.default)({method:"GET",url:"/api-tenant/leaseTerms?max="+e,contentType:"application/json"}).then(function(e){200===e.status&&t.setState({discount:e.data[0].discount})})}},{key:"getAccountBalance",value:function(){var e=this;(0,y.default)({method:"GET",url:"/api-user/enterprise?id="+this.props.currentEnterprise,contentType:"application/json"}).then(function(t){200===t.status&&e.setState({accountId:t.data.account}),(0,y.default)({method:"GET",url:"/api-account/account?id="+e.state.accountId,contentType:"application/json"}).then(function(t){200===t.status&&e.setState({balance:t.data.balance})})})}},{key:"calculateAmount",value:function(e,t,a,n){return(Number(e)*Number(t)*Number(a)*Number(n)).toString()}},{key:"postTsDatabase",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,a){e||(t.calculateAmount(t.props.months,t.props.tsDatabaseSize,t.state.tsDatabasePrice,t.state.discount)<=t.state.balance?(0,y.default)({method:"post",url:"/api-account/useMoney",contentType:"application/json",withCredentials:!0,data:{accountId:t.state.accountId,money:"-"+t.calculateAmount(t.props.months,t.props.tsDatabaseSize,t.state.tsDatabasePrice,t.state.discount),content:"申请时序数据库资源",userId:t.props.currentEnterprise,category:"资源"}}).then(function(e){200===e.status&&(0,y.default)({method:"post",url:"/api-tenant/org/tsdatabase",contentType:"application/json",withCredentials:!0,data:{currentEnterprise:t.props.currentEnterprise,months:t.props.months,tsDatabaseSize:t.props.tsDatabaseSize}}).then(function(e){200===e.status?i.default.success("申请时序数据库存储空间成功",5):i.default.error("申请时序数据库存储空间失败",5)})}):t.showBalanceModal())})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a={labelCol:{xs:{span:24},sm:{span:24},md:{span:24},lg:{span:6}},wrapperCol:{xs:{span:24},sm:{span:24},md:{span:24},lg:{span:12}}},i={wrapperCol:{xs:{span:24,offset:0},sm:{span:24,offset:0},md:{span:24,offset:0},lg:{span:18,offset:6}}};return b.default.createElement("div",{style:{padding:"30px"}},b.default.createElement(n.default,null,b.default.createElement(r.default,{span:18,offset:3},b.default.createElement(s.default,{title:"申请时序数据库空间资源"},b.default.createElement(d.default,null,b.default.createElement(g,f({},a,{label:"租用时长"}),t("months",{getValueFromEvent:function(e){return e.target.value},rules:[{required:!0,message:"请输入租用时长!"},{pattern:/^[0-9]+$/,message:"月份必须是正整数!"}]})(b.default.createElement(p.default,{addonAfter:"个月",placeholder:"请输入租用时长",onChange:function(t){e.props.update({name:"months",value:t.target.value}),e.getLeaseTermDiscount(t.target.value)}}))),b.default.createElement(g,f({},a,{label:"租用时长折扣信息"}),b.default.createElement(_,{rows:4,disabled:!0,value:"0-3个月，无折扣；\n3-12个月，9折；\n12-24个月，8折；\n24个月以上，7折。"})),b.default.createElement(g,f({},a,{label:"时序数据库存储空间"}),t("tsDatabaseSize",{getValueFromEvent:function(e){return e.target.value},rules:[{required:!0,message:"请输入时序数据库存储空间!"},{pattern:/^[0-9]+$/,message:"时序数据库存储空间必须是正整数"}]})(b.default.createElement(p.default,{placeholder:"请输入时序数据库存储空间",addonAfter:"GB",onChange:function(t){e.props.update({name:"tsDatabaseSize",value:t.target.value}),""!==t.target.value?e.getTsDatabasePrice(t.target.value):e.setState({tsDatabasePrice:"0"})}}))),b.default.createElement(g,f({},a,{label:"时序数据库存储空间资费"}),b.default.createElement(_,{rows:3,disabled:!0,placeholder:"这里将根据时序数据库存储空间显示价格信息",value:"您当前选择的时序数据库存储空间资费为"+this.state.tsDatabasePrice+"元/GB"})),b.default.createElement(g,f({},a,{label:"合计金额"}),b.default.createElement(p.default,{placeholder:"这里将根据您的输入显示金额",disabled:!0,value:this.calculateAmount(this.props.months,this.props.tsDatabaseSize,this.state.tsDatabasePrice,this.state.discount)+"元"})),b.default.createElement(g,i,b.default.createElement(c.default,{onChange:this.checkboxChange},"我已阅读并同意",b.default.createElement("a",{onClick:this.showTermsModal},"相关服务条款")),b.default.createElement(l.default,{title:"服务条款",visible:this.state.termsModalVisible,onCancel:this.handleCancel,footer:[b.default.createElement(u.default,{type:"primary",onClick:this.handleCancel},"确定")]},b.default.createElement(_,{rows:10,value:"一、合同适用说明 1.本合同适用于首次购买XX产品及购买XX服务产品的用户。 2.甲乙双方签订本合同，表明甲方接受乙方所提供的标准服务；否则，视为甲方主动放弃乙方所提供的服务。\r 二、服务内容 1.乙方提供的服务内容：1）品标准培训：乙方负责承担甲方所购买产品的标准培训；标准培训为指导建账和为期四个工作小时的业务指导。2）热线支持：指乙方服务人员通过电话向用户提供技术问题解答的过程。\r 3）在线服务支持：指乙方通过在线支持系统接收、解答用户问题，并在网上发布相关技术解决问题的过程。4）现场维护：指乙方派遣技术人员到用户现场处理问题的过程。5）远程维护：指乙方通过《XX维护软件》解答用户问题的服务过程。\r 6）用户俱乐部活动：甲方可以参加XX用户俱乐部的活动。7）用户刊物：甲方可以不定期的获取乙方提供的用户刊物，用户刊物包括出版的刊物和电子刊物。2、乙方的服务承诺：\r 1）乙方接到甲方通过电话、信函传真、电子邮件、网上提交等方式提出关于XX软件的服务请求后，在两个有效工作日内给予响应并提供服务。2）乙方提供给甲方的服务，必须按照合同规定的服务内容进行。\r 三、甲方责任：1.甲方应确保有专人对xx软件的使用和管理负责。2.甲方应建立相关制度，以确保xx软件运行环境（包括计算机、打印机及相关硬件设备）3.甲方定期做好系统数据备份，并对备份数据进行妥善保管。\r 4.甲方在应用过程中发现软件出现异常，应及时与甲方取得联系，并记录当前故障现象，便于乙方作出诊断。5.甲方在乙方服务人员服务完成后，配合检查软件系统运行是否正常。\r 四、违约处理 1.乙方违争取处理：1）甲方有权对乙方不履行合同条款的行为向XX公司服务管理部门投诉；XX公司服务投诉电话：XXXXXXXX 2）乙方违反以上服务承诺时，在接到甲方投诉后，维护部门立即采取补救措施，并给用户满意答复。\r 3）乙方在确认违反了服务承诺，并给甲方造成实际损失，应该给甲方以适当的经济补偿。2.甲方违约处理 1）甲方没有按照合同要求履行甲方应承担的责任，甲方应该承担由此带来的相关后果。\r 2）因甲方法人员进行非法操作、感染病毒、配件出现故障导致的数据混乱、丢失等问题，甲方请求乙方提供服务的，乙方可以按照软件服务费的100%，加收服务费。\r 3.乙方免责条款 1）乙方不承担因甲方人员进行非法操作、感染病毒、硬件出现故障导致的数据混乱乱、丢失责任。2）乙方有权拒绝甲方提出的合同规定之外的服务请求。\r 五、合同有效期和效用性 1.本合同须双方签字并加盖公章或合同章生效；本合同一式两份，双方各执一份，具有同等法律效力\r 2.本合同的有效性不因双方代表的职务变换、工作变更、工作调动等情况而受任何影响；本合同的有效性不因双方法人的变更而受任何影响；本合同的有效性不因双方单位名称的改变而受任何影响。\r 六、收费办法和合同期限 1.购买XX版、XX版）大写：_______________. 2.合同有效期限为一年，自___年__月__日至___年__月__日止，合同期满自动中止。\r 3.合同期满后，双方协商，乙方可以继续为甲方提供用友软件运行维护服务；但双方必须重新签署新的服务合同。\r 七、争议处理 1.甲乙双方如对协议条款规定的理解有异议，或者对与协议有关的事项发生争议，双方应本着友好合作的精神进行协商。\r 2.协商不能解决的，依照《中华人民共和国合同法》，任何一方可向乙方所在地的人民法院起诉。\r 八、其他 1.本合同未尽事宜，由甲乙双方协商后产生书面文件，作为本合同的补充条款，具备与本合同同等法律效力。\r 2.对本合同内容的任何修改和变更需要用书面形式，并经双方确认后生效。\r 3.本合同为双方唯一的正式协议，其他任何方案、口头说明及与本项目有关的信函、传真、邮件等，均以本合同为准。"}))),b.default.createElement(g,i,b.default.createElement(u.default,{type:"primary",disabled:!1===this.state.checkboxStatus,onClick:this.postTsDatabase},"立即申请"),b.default.createElement(l.default,{title:b.default.createElement("span",null,b.default.createElement(o.default,{type:"warning",style:{color:"red",marginRight:"4px"}}),"警告"),visible:this.state.balanceModalVisible,onCancel:this.handleCancel,footer:[b.default.createElement(u.default,{onClick:this.handleCancel},"取消"),b.default.createElement(u.default,{type:"primary",onClick:this.handleCancel},"立即充值")]},b.default.createElement("p",null,"余额不足，请立即充值"))))))))}}]),t}();E=d.default.create()(E),t.default=(0,m.injectIntl)(E)},freZ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapDispatchToProps=t.mapStateToProps=undefined;var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=u(a("U7vG")),s=a("4n+p"),o=u(a("A82k")),l=a("1xD6");a("Zfgq");function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),n(t,[{key:"render",value:function(){return r.default.createElement(o.default,this.props)}}]),t}(),i=t.mapStateToProps=function(e){try{return{currentEnterprise:e.userData.enterprises[e.userData.currentEnterprise].id,tsDatabaseSize:e.applyTsdatabaseSpace.tsDatabaseSize,months:e.applyTsdatabaseSpace.months}}catch(e){return{currentEnterprise:""}}},p=t.mapDispatchToProps=function(e){return{dispatch:e,update:function(t){e((0,l.updateData)(t))}}};t.default=(0,s.connect)(i,p)(c)}});