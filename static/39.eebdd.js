webpackJsonp([39],{"0Yjm":function(e,t,a){(t=e.exports=a("FZ+f")(!0)).push([e.i,".src-scenes-PlatFormResourceMonitor-style_stateSummary--1z67BcIB{font-size:16px}.src-scenes-PlatFormResourceMonitor-style_colTextCenter--1wapPoLn{color:#e6e6e6}.src-scenes-PlatFormResourceMonitor-style_tableCol--1MdLbm5C{width:calc(24vw - 150px)}","",{version:3,sources:["D:/siacloud2/sia-cloud-foundation-v2/frontend/src/scenes/PlatFormResourceMonitor/D:/siacloud2/sia-cloud-foundation-v2/frontend/src/scenes/PlatFormResourceMonitor/style.less","D:/siacloud2/sia-cloud-foundation-v2/frontend/src/scenes/PlatFormResourceMonitor/style.less"],names:[],mappings:"AAAA,iEACE,cAAA,CCCD,ADCD,kEACE,aAAA,CCCD,ADED,6DACE,wBAAA,CCAD",file:"style.less",sourcesContent:['.stateSummary{\n  font-size:16px;\n}\n.colTextCenter{\n  color:#e6e6e6;\n  //text-align: center;\n}\n.tableCol{\n  width: calc(~"24vw - 150px");\n}\n',".stateSummary {\n  font-size: 16px;\n}\n.colTextCenter {\n  color: #e6e6e6;\n}\n.tableCol {\n  width: calc(24vw - 150px);\n}\n"],sourceRoot:""}]),t.locals={stateSummary:"src-scenes-PlatFormResourceMonitor-style_stateSummary--1z67BcIB",colTextCenter:"src-scenes-PlatFormResourceMonitor-style_colTextCenter--1wapPoLn",tableCol:"src-scenes-PlatFormResourceMonitor-style_tableCol--1MdLbm5C"}},OSsW:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(a("uuhB")),r=g(a("0b0c")),s=g(a("G3dI")),o=g(a("yF52")),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a("TZP0"),a("kxBb"),a("/Hhv"),a("tNTX");var c=a("U7vG"),d=g(c),u=a("4n+p"),m=g(a("WcUF")),f=a("Pq8k"),p=g(a("umdA")),h=a("1/kc"),y=g(a("mtWM"));function g(e){return e&&e.__esModule?e:{default:e}}var C=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.fetchPlatFormData=function(){(0,y.default)("/api-tenant/namespace/searchKubernetesInfo").then(function(e){e.data.isSuccess&&a.setState({cpuLimit:e.data.cpuLimit,cpuUsed:e.data.cpuUsed,cpuUnit:e.data.cpuUnit,memoryLimit:e.data.memoryLimit,memoryUsed:e.data.memoryUsed,memoryUnit:e.data.memoryUnit,diskLimit:e.data.diskLimit,diskUsed:e.data.diskUsed,diskUnit:e.data.diskUnit})}),(0,y.default)("/api-tenant/namespace/searchEachNamespaceInfoList").then(function(e){for(var t={},n=0;n<e.data.length;n++)t[e.data[n].enterpriseId]=[];a.setState({list:e.data,detailData:t})})},a.onExpand=function(e,t){e&&a.fetchDetailData(t.enterpriseId)},a.fetchDetailData=function(e){y.default.post("/api-tenant/app/searchListByEnterpriseId?enterpriseId="+e).then(function(t){var n,r,s;t.data&&t.data.isSuccess&&a.setState({detailData:i({},a.state.detailData,(n={},r=e,s=t.data.apps,r in n?Object.defineProperty(n,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[r]=s,n))})})},a.handleSearchChange=function(e){a.setState({filter:e.target.value})},a.state={list:[],detailData:{},cpuLimit:0,cpuUsed:0,cpuUnit:"核",memoryLimit:0,memoryUsed:0,memoryUnit:"MB",diskLimit:0,diskUsed:0,diskUnit:"MB",filter:""},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.Component),l(t,[{key:"componentDidMount",value:function(){this.fetchPlatFormData()}},{key:"componentWillUnmount",value:function(){}},{key:"intervalChart",value:function(e,t,a){var n={data:{alias:e,max:a,min:0}};return d.default.createElement("div",{className:m.default.tableCol},d.default.createElement(h.Chart,{forceFit:!0,padding:[10,70,10,10],height:30,data:[{data:t,max:a,index:0}],scale:n},d.default.createElement(h.Guide,null,d.default.createElement(h.Guide.Region,{start:[-1,0],end:[1,"max"],style:{fill:"#e6e6e6",fillOpacity:.5}})),d.default.createElement(h.Coord,{transpose:!0}),d.default.createElement(h.Tooltip,{type:"mini"}),d.default.createElement(h.Geom,{type:"interval",position:"index*data",color:["data*max",function(e,t){var a=[26,160,218],n=[255,0,0],r=function(e){for(var t="#",a=0;a<e.length;a++){var n=Math.round(e[a]);t+=n<16?0!==n?"0"+n.toString(16):"00":""+n.toString(16)}return t};if(e/t<.7)return r(a);if(e/t<1){for(var s=[0,0,0],o=0;o<s.length;o++)s[o]=0!==o?a[o]+(n[o]-a[o])*Math.sqrt(1-Math.pow(10*(e/t-.7)/3-1,2)):255;return r(s)}return r(n)}],size:20},d.default.createElement(h.Label,{content:["data*max",function(e,t){return e+"/"+t}],textStyle:{color:"#404040",fontSize:"12"},offset:10}))))}},{key:"render",value:function(){var e=this,t={pageSize:5},a={"000":d.default.createElement(f.FormattedMessage,{id:"scenes_SpaceAppsManagement_Booting"}),"001":d.default.createElement(f.FormattedMessage,{id:"scenes_SpaceAppsManagement_Running"}),"002":d.default.createElement(f.FormattedMessage,{id:"scenes_SpaceAppsManagement_Stopped"}),"003":d.default.createElement(f.FormattedMessage,{id:"scenes_SpaceAppsManagement_Crashed"})},i=[{title:"应用名称",dataIndex:"name",width:200,key:"name"},{title:"CPU",dataIndex:"cpu",key:"cpu",render:function(e,t,a){return t.cpuLimit}},{title:d.default.createElement(f.FormattedMessage,{id:"scenes_SpaceAppsManagement_Memory"}),dataIndex:"memory",key:"memory",render:function(e,t,a){return t.memoryLimit}},{title:d.default.createElement(f.FormattedMessage,{id:"scenes_SpaceAppsManagement_Storage"}),dataIndex:"disk",key:"disk",render:function(e,t,a){return t.diskLimit}},{title:d.default.createElement(f.FormattedMessage,{id:"scenes_SpaceAppsManagement_State"}),dataIndex:"status",key:"status",render:function(e){return a[e.code]}}],l=[{title:"公司名称",dataIndex:"name",width:200,key:"name"},{title:"CPU",dataIndex:"cpu",key:"cpu",render:function(t,a,n){return a.isSuccess?e.intervalChart("CPU",a.cpuUsed,a.cpuLimit):a.errormsg}},{title:d.default.createElement(f.FormattedMessage,{id:"scenes_SpaceAppsManagement_Memory"}),dataIndex:"memory",key:"memory",render:function(t,a,n){return a.isSuccess?e.intervalChart(d.default.createElement(f.FormattedMessage,{id:"scenes_SpaceAppsManagement_Memory"}),a.memoryUsed,a.memoryLimit):a.errormsg}},{title:d.default.createElement(f.FormattedMessage,{id:"scenes_SpaceAppsManagement_Storage"}),dataIndex:"disk",key:"disk",render:function(t,a,n){return a.isSuccess?e.intervalChart(d.default.createElement(f.FormattedMessage,{id:"scenes_SpaceAppsManagement_Storage"}),a.diskUsed,a.diskLimit):a.errormsg}}],c=this.state.list.filter(function(t){return t.name.includes(e.state.filter)});return d.default.createElement("div",null,d.default.createElement("h2",null,"平台资源监控"),d.default.createElement("hr",null),d.default.createElement(r.default,null,d.default.createElement(s.default,{span:8},d.default.createElement(p.default,{type:"divided",label:this.props.intl.formatMessage({id:"scenes_common_ConsoleHome_ResourceMonitorComponent_CpuUsage"}),value:this.state.cpuUsed,unit:this.state.cpuUnit,range:this.state.cpuLimit,greenColor:"#26a0da",firstValue:70,height:240})),d.default.createElement(s.default,{span:8},d.default.createElement(p.default,{type:"divided",label:this.props.intl.formatMessage({id:"scenes_common_ConsoleHome_ResourceMonitorComponent_MemoryRatio"}),value:this.state.memoryUsed,unit:this.state.memoryUnit,range:this.state.memoryLimit,greenColor:"#26a0da",firstValue:70,height:240})),d.default.createElement(s.default,{span:8},d.default.createElement(p.default,{type:"divided",label:this.props.intl.formatMessage({id:"scenes_common_ConsoleHome_ResourceMonitorComponent_DiskRatio"}),value:this.state.diskUsed,unit:this.state.diskUnit,range:this.state.diskLimit,greenColor:"#26a0da",firstValue:70,height:240}))),d.default.createElement(r.default,null,d.default.createElement(s.default,{span:12,className:m.default.colTextCenter},d.default.createElement(n.default,{placeholder:"搜索公司名称",style:{width:"80%",margin:"40px 0px"},onChange:this.handleSearchChange}))),d.default.createElement(o.default,{columns:l,dataSource:c,pagination:t,rowKey:"enterpriseId",expandedRowRender:function(a,n,r,s){return d.default.createElement(o.default,{columns:i,dataSource:e.state.detailData[a.enterpriseId],pagination:t})},onExpand:this.onExpand}))}}]),t}();t.default=(0,u.connect)(function(e){return{}},function(e,t){return{dispatch:e}})((0,f.injectIntl)(C))},WcUF:function(e,t,a){var n=a("0Yjm");"string"==typeof n&&(n=[[e.i,n,""]]);a("fjbf")(n,{});n.locals&&(e.exports=n.locals)}});